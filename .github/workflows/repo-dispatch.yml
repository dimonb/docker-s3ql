name: repo-dispatch

on:
  workflow_dispatch:

jobs:
  dispatch:
    strategy:
      matrix:
        branch: ['stable']
    runs-on: ubuntu-latest
    steps:
      - id: get-tag
        uses: proudust/gh-describe@v1
        with:
          commit-ish: ${{ matrix.branch }}
          match: '^v\d+(\.\d+)*$'

      - id: run-build
        uses: benc-uk/workflow-dispatch@v1
        with:
          workflow: docker-build-publish
          ref: ${{steps.get-tag.outputs.tag}}
